package sale;

import java.sql.*;
import java.util.*;

import product.Database;


public class SaleDAO {
	//매출현황
	Connection con = Database.CON;
	public ArrayList<SaleVO> list(){
		ArrayList<SaleVO> array = new ArrayList<SaleVO>();
		try {
			String sql = "select sale_date, code,sum(qnt),price, name\r\n";
				sql+= "from view_sale\r\n";
				sql+= "group by sale_date, code, price, name\r\n";
				sql+= "order by sale_date asc, code asc;";
			PreparedStatement ps = con.prepareStatement(sql); 
			ResultSet rs = ps.executeQuery();
			while(rs.next()) {
				SaleVO vo = new SaleVO();
				vo.setSale_date(rs.getDate("sale_date"));
				vo.setCode(rs.getString("code"));
				vo.setQnt(rs.getInt("sum(qnt)"));
				vo.setPrice(rs.getInt("price"));
				vo.setName(rs.getString("name"));
				array.add(vo);
			}
		
		}catch(Exception e) {
			System.out.println("매출현황:" + e.toString());
		}
		return array;
	} 
}
